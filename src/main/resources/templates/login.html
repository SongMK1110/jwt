<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://code.jquery.com/jquery-3.7.1.js"
            integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
</head>
<body>
<div>
    <div>
        <h1>로그인 페이지</h1>
        <label> 이메일 :
            <input type="text" name="email" id="email">
        </label>
        <label> 비밀번호 :
            <input type="password" name="pw" id="pw">
        </label>
        <button type="button" id="loginBtn">로그인</button>
    </div>
</div>
<a href="/sign-up-form">
    <button>회원가입</button>
</a>
<script>
    $(document).on("click", "#loginBtn", function () {
        const email = $("#email").val()
        const pw = $("#pw").val()
        console.log(email)
        console.log(pw)

        $.ajax({
            type: "post",
            url: "/login",
            contentType: "application/json",
            data: JSON.stringify({
                email: email,
                pw: pw
            }),
            success: function (res) {
                // 응답에서 토큰을 가져와서 "Bearer "를 붙여서 저장
                const token = "Bearer " + res;

                // 로컬 스토리지에 토큰 저장
                localStorage.setItem("Authorization", token);

                console.log("Token: " + token);

                // 로그인 성공 후 페이지 리다이렉트
                location.href = "/";
            },
            error: function (error) {
                console.log(error)
            }
        })
    })
</script>
</body>
</html>
